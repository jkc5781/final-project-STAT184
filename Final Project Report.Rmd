---
title: "Final Project Report"
author: "Jared Cao, Macklin Yarris, Abby Crilley"
date: "April 24th, 2020"
output: 
    html_notebook:
    fig_height: 6
    fig_width: 10
---
### Clean up environment and load packages
```{r}
# clean up the RStudio environment 
rm(list = ls())

# load all packages here: `mosaic`, `tidyverse`, `lubridate`, and all others used
library(tidyverse)
library(mosaic)
library(lubridate)
library(DataComputing)
```

## Guiding Question:

# Are suicide rates and world happiness inversely correlated?
Our goal of this report is to look into whether or not countries that are generally happier have less citizens committing suicide. We have found a few data sets that will help us come up with an answer to this question. By combining data gathered on suicides across the world and reports on world happiness over the years, we have been able to make some insights.
<br>

## Data Access

### Download all data files needed
```{r}
SuicideRates <-
  read.csv(file.choose())
```

```{r}
WorldHappiness2015 <-
  read.csv(file.choose())
```

```{r}
WorldHappiness2016 <-
  read.csv(file.choose())
```

```{r}
head(SuicideRates)
head(WorldHappiness2015)
head(WorldHappiness2016)
```

## Data Wrangling

<br>

###Join 2015 and 2016 World Happiness tables
```{r}
WorldHappiness2015 <-
  WorldHappiness2015 %>%
  mutate(year = "Happiness2015")

WorldHappiness2016 <-
  WorldHappiness2016 %>%
  mutate(year = "Happiness2016")

WorldHappiness <-
  WorldHappiness2015 %>%
  full_join(WorldHappiness2016)
```

### Only get years 2015 and 2016 from the suicide master table
```{r}
RecentSuicideRates <-
  SuicideRates %>%
  filter(year == 2015 | year == 2016)
```

### Select and group by key values in suicide table
```{r}
RecentSuicideRates <-
  RecentSuicideRates %>%
  select(country, year, sex, population, suicides_no, suicides.100k.pop)

RecentSuicideRates <-
  RecentSuicideRates %>%
  group_by(country, year, sex) %>%
  summarise(totalsuicides = sum(suicides_no))
RecentSuicideRates
```

### select key values in happiness table
```{r}
WorldHappiness <-
  WorldHappiness %>%
  select(country = Country, Happiness.Score, year)
```

### Spread suicide table
```{r}
SuicideByYear <-
  RecentSuicideRates %>%
  spread(key = year, value = totalsuicides)

```

### Omit any NA values and rename 2015 and 2016 columns
```{r}
Suicide2015<-
  SuicideByYear[1:3]
names(Suicide2015)[3] <- "Year2015"

SuicideByYear <-
  SuicideByYear %>%
  na.omit()

names(SuicideByYear)[3] <- "Year2015"
names(SuicideByYear)[4] <- "Year2016"
```

### Spread World Happiness table and omit any NA values
```{r}
WorldHappinessByYear <-
  WorldHappiness %>%
  spread(key = year, value = Happiness.Score) %>%
  na.omit

H2015<-WorldHappinessByYear[1:2]
```

### Join the Happiness and Suicide tables to analyze the correlation
```{r}
SuicideHappiness <-
  SuicideByYear %>%
  inner_join(WorldHappinessByYear)

SH2015<-
Suicide2015%>%
  inner_join(H2015)
SH2015
```


## Data Visualization
```{r}
SuicideHappiness%>%
  ggplot(aes(x = Happiness2015, y = Year2015, color = country)) +
  geom_point() +
  geom_point(aes(x = Happiness2016, y = Year2016, color = country, fill = country), alpha = 0.5) +
  facet_wrap(~sex) +
  xlab("Happiness Scores in 2015-16") +
  ylab("Suicides in 2015-16") +
  theme(legend.position = "bottom") +
  ylim(0, 2000)
```
There is slight inverse correlation between suicide rate and happiness value, but not enough to say they effect each others values.


# Graph of just 2015 suicide and happiness values
```{r}

SH2015%>%
  ggplot(aes(x = Happiness2015, y = Year2015)) +
  geom_point() +
  geom_smooth() +
  ylim(0, 10000) +
  ylab("Country Suicides in 2015") +
  xlab("Country Happiness Scores in 2015")
```
We separated the 2015 and 2016 values because there is more data from 2015 than 2016. There are about 100 glyphs in 2015 rather than the joined 2015 and 2016 there are only 28. From this graph we have more data points and can easily tell the rate of suicides start to drop when the happiness value reaches 7. We can conclude that when a country's happiness value is in the highest range the suicide rates decrease.
